<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zerody.user.mapper.SysStaffInfoMapper" >
  <resultMap id="BaseResultMap" type="com.zerody.user.pojo.SysStaffInfo" >
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="comp_id" property="compId" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="work_place" property="workPlace" jdbcType="VARCHAR" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="date_join" property="dateJoin" jdbcType="DATE" />
    <result column="conversion_date" property="conversionDate" jdbcType="DATE" />
    <result column="date_left" property="dateLeft" jdbcType="DATE" />
    <result column="create_id" property="createId" jdbcType="VARCHAR" />
    <result column="create_user" property="createUser" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="update_id" property="updateId" jdbcType="VARCHAR" />
    <result column="update_user" property="updateUser" jdbcType="VARCHAR" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="status" property="status" jdbcType="TINYINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, comp_id, user_id, user_name, work_place, job_number, date_join, conversion_date, 
    date_left, create_id, create_user, create_time, update_id, update_user, update_time, 
    status
  </sql>
  <select id="selectByUserIdAndCompId" resultType="com.zerody.user.vo.SysStaffInfoVo" >
      SELECT
          id,
          comp_id,
          user_id,
          user_name,
          work_place,
          job_number,
          date_join,
          conversion_date,
          date_left
      FROM
          sys_staff_info
      WHERE
          STATUS != 2
      AND user_id = #{userId}
      AND comp_id = #{compId}
  </select>
  <select id="selectPageStaffByRoleId"  resultType="com.zerody.user.vo.SysStaffInfoVo">
       SELECT
            ssi.id,
            ssi.comp_id,
            ssi.user_id,
            ssi.user_name,
            ssi.work_place,
            ssi.job_number,
            ssi.date_join,
            ssi.conversion_date,
            ssi.date_left
       FROM
          sys_staff_info ssi
       join  union_role_staff urs on urs.staff_id = ssi.id
       <where>
          status = 1
          <if test="staffiId != null and staffId != ''">
             and urs.staff_id = #{staffId}
          </if>
       </where>
  </select>
  <select id="getPageAllStaff" resultType="com.zerody.user.vo.SysStaffInfoVo">

  </select>
    <select id="selectUserByCompanyId" resultType="java.lang.String">
        SELECT
			id
		FROM
			sys_user_info sui
		JOIN sys_staff_info ssi ON ssi.user_id = sui.id
		WHERE
			ssi.comp_id = #{companyId} and ssi.status != 2 and sui.status != -1
    </select>
</mapper>